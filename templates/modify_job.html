{% extends "base.html" %}

{% block title %}
    Modify Job
{% endblock %}

{% block content %}
    <!-- Content Block -->

    <!-- Breadcrumb navigation-->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{{ url_for('home') }}">Home</a>
            </li>
            <li class="breadcrumb-item">
                <a href="{{ url_for('currentjobs') }}">Current Job</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">Modify Job</li>
        </ol>
    </nav>

    <!-- Accordion Component -->
    <div class="accordion" id="accordionPanelsStayOpenExample">
        <!-- Accordion Item: Customer Information -->
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseOne"
                        aria-expanded="false"
                        aria-controls="panelsStayOpen-collapseOne">
                    Customer Information
                </button>
            </h2>
            <div id="panelsStayOpen-collapseOne"
                 class="accordion-collapse collapse">
                <div class="accordion-body">
                    <!-- Loop to display customer info -->
                    {% for job_id, job_info in job_parts_services_qty.items() %}
                        Customer ID: {{ job_id }}<br>
                        Name: {{ job_info.name }}<br>
                        Date: {{ job_info.date }}
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Accordion Item: Parts Information -->
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseTwo"
                        aria-expanded="false"
                        aria-controls="panelsStayOpen-collapseTwo">
                    Parts Information
                </button>
            </h2>
            <div id="panelsStayOpen-collapseTwo"
                 class="accordion-collapse collapse">
                <div class="accordion-body">
                    <!-- Loop to display part info -->
                    {% for job_id, job_info in job_parts_services_qty.items() %}
                        {% for part, quantity in job_info['parts'].items() %}
                            Part: {{ part }}<br>
                            Quantity: {{ quantity }}<br>
                        {% endfor %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Accordion Item: Service Information -->
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseThree"
                        aria-expanded="false"
                        aria-controls="panelsStayOpen-collapseThree">
                    Service Information
                </button>
            </h2>
            <div id="panelsStayOpen-collapseThree"
                 class="accordion-collapse collapse">
                <div class="accordion-body">
                    <!-- Loop to display service info -->
                    {% for job_id, job_info in job_parts_services_qty.items() %}
                        {% for service, quantity in job_info['services'].items() %}
                            Service: {{ service }}<br>
                            Quantity: {{ quantity }}<br>
                        {% endfor %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Form to add part -->
    <form method="POST">
        <div class="mb-3">
            <label for="part" class="form-label">Add Part</label>
            <select class="form-select" id="part" name="part">
                <option selected value="">Choose...</option>
                {% for part in parts %}
                    <option value="{{ part[0] }}" {% if part_id == part[0] %} selected {% endif %}>{{ part[1] }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="part_qty" class="form-label">Part Quantity</label>
            <input class="form-control"
                   type="number"
                   id="part_qty"
                   name="part_qty"
                   value="{{ part_qty }}">
        </div>
        <button type="submit" class="btn btn-primary">Add Part</button>
    </form>

    <!-- Form to add service -->
    <form method="POST">
        <div class="mb-3">
            <label for="service" class="form-label">Add Service</label>
            <select class="form-select" id="service" name="service">
                <option selected value="">Choose...</option>
                {% for service in services %}
                    <option value="{{ service[0] }}" {% if service_id == service[0] %} selected {% endif %}>{{ service[1] }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="service_qty" class="form-label">Service Quantity</label>
            <input class="form-control"
                   type="number"
                   id="service_qty"
                   name="service_qty"
                   value="{{ service_qty }}">
        </div>
        <button type="submit" class="btn btn-primary">Add Service</button>
    </form>

</div>
{% endblock %}